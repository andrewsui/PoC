use windows::Win32;

pub fn is_elevated() -> bool {
    unsafe {
        let mut token: Win32::Foundation::HANDLE = Win32::Foundation::HANDLE::default();
        _ = Win32::System::Threading::OpenProcessToken(
            Win32::System::Threading::GetCurrentProcess(),
            Win32::Security::TOKEN_QUERY,
            &mut token
        );

        let mut output_size: u32 = 0;
        let mut token_elevation: Win32::Security::TOKEN_ELEVATION = Win32::Security::TOKEN_ELEVATION::default();

        _ = Win32::Security::GetTokenInformation(
            token,
            Win32::Security::TokenElevation,
            Some(&mut token_elevation as *mut Win32::Security::TOKEN_ELEVATION as *mut _),
            std::mem::size_of::<Win32::Security::TOKEN_ELEVATION_TYPE>() as u32,
            &mut output_size,
        );

        return token_elevation.TokenIsElevated != 0;
    }
}
